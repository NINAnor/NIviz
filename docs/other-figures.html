<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Other figures | NIvis</title>
<meta name="description" content="5.1 Wordcloud figures  library(wordcloud) library(NIcalc) library(wordcloud2) library(RColorBrewer) library(readxl) library(dplyr) library(tm) The following wordcloud figures show the pressure...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 5 Other figures | NIvis">
<meta property="og:type" content="book">
<meta property="og:description" content="5.1 Wordcloud figures  library(wordcloud) library(NIcalc) library(wordcloud2) library(RColorBrewer) library(readxl) library(dplyr) library(tm) The following wordcloud figures show the pressure...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 5 Other figures | NIvis">
<meta name="twitter:description" content="5.1 Wordcloud figures  library(wordcloud) library(NIcalc) library(wordcloud2) library(RColorBrewer) library(readxl) library(dplyr) library(tm) The following wordcloud figures show the pressure...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.20/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">NIvis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="downloading-and-preparing-example-data.html"><span class="header-section-number">2</span> Downloading and preparing example data</a></li>
<li><a class="" href="cross.html"><span class="header-section-number">3</span> Time series</a></li>
<li><a class="" href="maps.html"><span class="header-section-number">4</span> Maps</a></li>
<li><a class="active" href="other-figures.html"><span class="header-section-number">5</span> Other figures</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/NINAnor/NIviz">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="other-figures" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Other figures<a class="anchor" aria-label="anchor" href="#other-figures"><i class="fas fa-link"></i></a>
</h1>
<div id="wordcloud-figures" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Wordcloud figures<a class="anchor" aria-label="anchor" href="#wordcloud-figures"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://blog.fellstat.com/?cat=11">wordcloud</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">NIcalc</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lchiffon/wordcloud2">wordcloud2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tm.r-forge.r-project.org/">tm</a></span><span class="op">)</span></code></pre></div>
<p>The following wordcloud figures show the pressure factors for each indicator, where both the color saturation and text size represent the importance of each pressure factor. Small text size and low saturation means low importance, while large text size represent pressure factors with high importance to the indicator.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="other-figures.html#cb25-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2"><a href="other-figures.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset</span></span>
<span id="cb25-3"><a href="other-figures.html#cb25-3" aria-hidden="true" tabindex="-1"></a>pressure <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="st">"P:/41201612_naturindeks_2021_2023_database_og_innsynslosning/Pilot_Forbedring_Innsynsløsning/R/Indikator_paavirkning.xlsx"</span>)</span>
<span id="cb25-4"><a href="other-figures.html#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="other-figures.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for species of interest</span></span>
<span id="cb25-6"><a href="other-figures.html#cb25-6" aria-hidden="true" tabindex="-1"></a>pressure <span class="ot">=</span> pressure <span class="sc">%&gt;%</span> <span class="fu">filter</span>(navn_norsk <span class="sc">==</span> <span class="st">"Elg"</span> <span class="sc">|</span> navn_norsk <span class="sc">==</span> <span class="st">"Dikesoldogg"</span> <span class="sc">|</span> navn_norsk <span class="sc">==</span> <span class="st">"Havørn"</span> <span class="sc">|</span> navn_norsk <span class="sc">==</span> <span class="st">"Lange"</span> <span class="sc">|</span> navn_norsk <span class="sc">==</span> <span class="st">"Jerv"</span> <span class="sc">|</span> navn_norsk <span class="sc">==</span> <span class="st">"Lomvi"</span>) <span class="co"># NB - Jerv was not included in the provided excel file</span></span>
<span id="cb25-7"><a href="other-figures.html#cb25-7" aria-hidden="true" tabindex="-1"></a>pressure <span class="ot">=</span> <span class="fu">arrange</span>(pressure, <span class="at">by =</span> navn_norsk)</span>
<span id="cb25-8"><a href="other-figures.html#cb25-8" aria-hidden="true" tabindex="-1"></a>pressure <span class="ot">=</span> pressure <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">PressureFactor =</span> Paavirkningsfaktor, <span class="at">PressureValue =</span> FK_PaavirkningsverdiID)</span>
<span id="cb25-9"><a href="other-figures.html#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="other-figures.html#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove all instances of "Ikke rel/ukjent" category" and increase the value of pressure factors for better contrast in wordcloud figures</span></span>
<span id="cb25-11"><a href="other-figures.html#cb25-11" aria-hidden="true" tabindex="-1"></a>pressure <span class="ot">=</span> pressure <span class="sc">%&gt;%</span> <span class="fu">filter</span>(PressureValue <span class="sc">!=</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">PressureValue =</span> PressureValue<span class="sc">*</span><span class="dv">2</span>) </span>
<span id="cb25-12"><a href="other-figures.html#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="other-figures.html#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create separate datasets for the different species</span></span>
<span id="cb25-14"><a href="other-figures.html#cb25-14" aria-hidden="true" tabindex="-1"></a>dikesoldogg <span class="ot">=</span> pressure <span class="sc">%&gt;%</span> <span class="fu">filter</span>(navn_norsk <span class="sc">==</span> <span class="st">"Dikesoldogg"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(PressureFactor, PressureValue)</span>
<span id="cb25-15"><a href="other-figures.html#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="other-figures.html#cb25-16" aria-hidden="true" tabindex="-1"></a>elg <span class="ot">=</span> pressure <span class="sc">%&gt;%</span> <span class="fu">filter</span>(navn_norsk <span class="sc">==</span> <span class="st">"Elg"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(PressureFactor, PressureValue)</span>
<span id="cb25-17"><a href="other-figures.html#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="other-figures.html#cb25-18" aria-hidden="true" tabindex="-1"></a>havørn <span class="ot">=</span> pressure <span class="sc">%&gt;%</span> <span class="fu">filter</span>(navn_norsk <span class="sc">==</span> <span class="st">"Havørn"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(PressureFactor, PressureValue)</span>
<span id="cb25-19"><a href="other-figures.html#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="other-figures.html#cb25-20" aria-hidden="true" tabindex="-1"></a>lange <span class="ot">=</span> pressure <span class="sc">%&gt;%</span> <span class="fu">filter</span>(navn_norsk <span class="sc">==</span> <span class="st">"Lange"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(PressureFactor, PressureValue)</span>
<span id="cb25-21"><a href="other-figures.html#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="other-figures.html#cb25-22" aria-hidden="true" tabindex="-1"></a>lomvi <span class="ot">=</span> pressure <span class="sc">%&gt;%</span> <span class="fu">filter</span>(navn_norsk <span class="sc">==</span> <span class="st">"Lomvi"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(PressureFactor, PressureValue)</span>
<span id="cb25-23"><a href="other-figures.html#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="other-figures.html#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a custom color gradient (green in this case)</span></span>
<span id="cb25-25"><a href="other-figures.html#cb25-25" aria-hidden="true" tabindex="-1"></a>pressureColors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#bde4aa"</span>, <span class="st">"#addb9d"</span>, <span class="st">"#9cd28f"</span>, <span class="st">"#8cc982"</span>, <span class="st">"#7dc275"</span>, <span class="st">"#6cb967"</span>, <span class="st">"#5db15a"</span>, <span class="st">"#50a54e"</span>, <span class="st">"#479845"</span>, <span class="st">"#3f8c3b"</span>, <span class="st">"#367e31"</span>, <span class="st">"#2e7228"</span>, <span class="st">"#25661f"</span>) </span></code></pre></div>
</div>
<div id="the-most-important-pressure-factors-for-dikesoldogg-oblong-leaved-sundew" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> The most important pressure factors for dikesoldogg (oblong-leaved sundew)<a class="anchor" aria-label="anchor" href="#the-most-important-pressure-factors-for-dikesoldogg-oblong-leaved-sundew"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Dikesoldogg</span>
<span class="fu"><a href="https://rdrr.io/pkg/wordcloud/man/wordcloud.html">wordcloud</a></span><span class="op">(</span>words <span class="op">=</span> <span class="va">dikesoldogg</span><span class="op">$</span><span class="va">PressureFactor</span>, freq <span class="op">=</span> <span class="va">dikesoldogg</span><span class="op">$</span><span class="va">PressureValue</span>, min.freq <span class="op">=</span> <span class="fl">1</span>, max.words <span class="op">=</span> <span class="fl">200</span>, random.order <span class="op">=</span> <span class="cn">FALSE</span>, rot.per <span class="op">=</span> <span class="fl">0.35</span>, colors <span class="op">=</span> <span class="va">pressureColors</span>, scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="co"># use rot.per to set the percentage of words that are at a 90 degree angle</span></code></pre></div>
<div class="inline-figure"><img src="04-other_figures_files/figure-html/Wordcloud%20-%20Dikesoldogg-1.png" width="672"></div>
</div>
<div id="the-most-important-pressure-factors-for-elg-moose" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> The most important pressure factors for elg (Moose)<a class="anchor" aria-label="anchor" href="#the-most-important-pressure-factors-for-elg-moose"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/pkg/wordcloud/man/wordcloud.html">wordcloud</a></span><span class="op">(</span>words <span class="op">=</span> <span class="va">elg</span><span class="op">$</span><span class="va">PressureFactor</span>, freq <span class="op">=</span> <span class="va">elg</span><span class="op">$</span><span class="va">PressureValue</span>, min.freq <span class="op">=</span> <span class="fl">1</span>, max.words <span class="op">=</span> <span class="fl">200</span>, random.order <span class="op">=</span> <span class="cn">FALSE</span>, rot.per <span class="op">=</span> <span class="fl">0.35</span>, colors <span class="op">=</span> <span class="va">pressureColors</span>, scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-other_figures_files/figure-html/Wordcloud%20-%20Elg-1.png" width="672"></div>
</div>
<div id="the-most-important-pressure-factors-for-havørn-white-tailed-eagle" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> The most important pressure factors for havørn (White-tailed eagle)<a class="anchor" aria-label="anchor" href="#the-most-important-pressure-factors-for-hav%C3%B8rn-white-tailed-eagle"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="other-figures.html#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="other-figures.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(<span class="at">words =</span> havørn<span class="sc">$</span>PressureFactor, <span class="at">freq =</span> havørn<span class="sc">$</span>PressureValue, <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">max.words =</span> <span class="dv">200</span>, <span class="at">random.order =</span> <span class="cn">FALSE</span>, <span class="at">rot.per =</span> <span class="fl">0.35</span>, <span class="at">colors =</span> pressureColors, <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<div class="inline-figure"><img src="04-other_figures_files/figure-html/Wordcloud%20-%20Hav%C3%B8rn-1.png" width="672"></div>
</div>
<div id="the-most-important-pressure-factors-for-lange-common-ling" class="section level2" number="5.5">
<h2>
<span class="header-section-number">5.5</span> The most important pressure factors for Lange (Common ling)<a class="anchor" aria-label="anchor" href="#the-most-important-pressure-factors-for-lange-common-ling"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/pkg/wordcloud/man/wordcloud.html">wordcloud</a></span><span class="op">(</span>words <span class="op">=</span> <span class="va">lange</span><span class="op">$</span><span class="va">PressureFactor</span>, freq <span class="op">=</span> <span class="va">lange</span><span class="op">$</span><span class="va">PressureValue</span>, min.freq <span class="op">=</span> <span class="fl">1</span>, max.words <span class="op">=</span> <span class="fl">200</span>, random.order <span class="op">=</span> <span class="cn">FALSE</span>, rot.per <span class="op">=</span> <span class="fl">0.35</span>, colors <span class="op">=</span> <span class="va">pressureColors</span>, scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-other_figures_files/figure-html/Wordcloud%20-%20Lange-1.png" width="672"></div>
</div>
<div id="the-most-important-pressure-factors-for-lomvi-common-guillemot" class="section level2" number="5.6">
<h2>
<span class="header-section-number">5.6</span> The most important pressure factors for Lomvi (common guillemot)<a class="anchor" aria-label="anchor" href="#the-most-important-pressure-factors-for-lomvi-common-guillemot"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/pkg/wordcloud/man/wordcloud.html">wordcloud</a></span><span class="op">(</span>words <span class="op">=</span> <span class="va">lomvi</span><span class="op">$</span><span class="va">PressureFactor</span>, freq <span class="op">=</span> <span class="va">lomvi</span><span class="op">$</span><span class="va">PressureValue</span>, min.freq <span class="op">=</span> <span class="fl">1</span>, max.words <span class="op">=</span> <span class="fl">200</span>, random.order <span class="op">=</span> <span class="cn">FALSE</span>, rot.per <span class="op">=</span> <span class="fl">0.35</span>, colors <span class="op">=</span> <span class="va">pressureColors</span>, scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-other_figures_files/figure-html/Wordcloud%20-%20Lomvi-1.png" width="672"></div>
</div>
<div id="data-type" class="section level2" number="5.7">
<h2>
<span class="header-section-number">5.7</span> Data type<a class="anchor" aria-label="anchor" href="#data-type"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"R/colorPalettes.R"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Elg datatyper</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  category<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ekspert"</span>, 
             <span class="st">"Modeller"</span>, 
             <span class="st">"Overvåkning"</span><span class="op">)</span>,
  count<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.9</span>, <span class="fl">95.1</span>, <span class="fl">0</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># load library</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; -- Attaching packages ------------------- tidyverse 1.3.1 --</span>
<span class="co">#&gt; v ggplot2 3.3.5     v purrr   0.3.4</span>
<span class="co">#&gt; v tibble  3.1.6     v stringr 1.4.0</span>
<span class="co">#&gt; v tidyr   1.2.0     v forcats 0.5.1</span>
<span class="co">#&gt; v readr   2.1.2</span>
<span class="co">#&gt; -- Conflicts ---------------------- tidyverse_conflicts() --</span>
<span class="co">#&gt; x ggplot2::annotate() masks NLP::annotate()</span>
<span class="co">#&gt; x dplyr::filter()     masks stats::filter()</span>
<span class="co">#&gt; x dplyr::lag()        masks stats::lag()</span>
<span class="co"># Compute percentages</span>
<span class="va">data</span><span class="op">$</span><span class="va">fraction</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">count</span><span class="op">)</span>

<span class="co"># Compute the cumulative percentages (top of each rectangle)</span>
<span class="va">data</span><span class="op">$</span><span class="va">ymax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">fraction</span><span class="op">)</span>

<span class="co"># Compute the bottom of each rectangle</span>
<span class="va">data</span><span class="op">$</span><span class="va">ymin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">ymax</span>, n<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Compute label position</span>
<span class="va">data</span><span class="op">$</span><span class="va">labelPosition</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">ymax</span> <span class="op">+</span> <span class="va">data</span><span class="op">$</span><span class="va">ymin</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>
<span class="va">data</span><span class="op">$</span><span class="va">labelPosition</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">0.8</span>
<span class="co"># Compute a good label</span>
<span class="va">data</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">category</span>, <span class="st">"\n "</span>, <span class="va">data</span><span class="op">$</span><span class="va">count</span>, <span class="st">" %"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel">ggrepel</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: package 'ggrepel' was built under R version 4.1.3</span>
<span class="co"># Make the plot</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymax<span class="op">=</span><span class="va">ymax</span>, ymin<span class="op">=</span><span class="va">ymin</span>, xmax<span class="op">=</span><span class="fl">4</span>, xmin<span class="op">=</span><span class="fl">3</span>, fill<span class="op">=</span><span class="va">category</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">labelPosition</span>, label<span class="op">=</span><span class="va">label</span>, color<span class="op">=</span><span class="va">category</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span> <span class="co"># x here controls label position (inner / outer)</span>
  <span class="fu">scale_fill_NIviz_d</span><span class="op">(</span><span class="st">"IndMap_cols"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_colour_NIviz_d</span><span class="op">(</span><span class="st">"IndMap_cols"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar</a></span><span class="op">(</span>theta<span class="op">=</span><span class="st">"y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-other_figures_files/figure-html/unnamed-chunk-2-1.png" width="672"></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="maps.html"><span class="header-section-number">4</span> Maps</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#other-figures"><span class="header-section-number">5</span> Other figures</a></li>
<li><a class="nav-link" href="#wordcloud-figures"><span class="header-section-number">5.1</span> Wordcloud figures</a></li>
<li><a class="nav-link" href="#the-most-important-pressure-factors-for-dikesoldogg-oblong-leaved-sundew"><span class="header-section-number">5.2</span> The most important pressure factors for dikesoldogg (oblong-leaved sundew)</a></li>
<li><a class="nav-link" href="#the-most-important-pressure-factors-for-elg-moose"><span class="header-section-number">5.3</span> The most important pressure factors for elg (Moose)</a></li>
<li><a class="nav-link" href="#the-most-important-pressure-factors-for-hav%C3%B8rn-white-tailed-eagle"><span class="header-section-number">5.4</span> The most important pressure factors for havørn (White-tailed eagle)</a></li>
<li><a class="nav-link" href="#the-most-important-pressure-factors-for-lange-common-ling"><span class="header-section-number">5.5</span> The most important pressure factors for Lange (Common ling)</a></li>
<li><a class="nav-link" href="#the-most-important-pressure-factors-for-lomvi-common-guillemot"><span class="header-section-number">5.6</span> The most important pressure factors for Lomvi (common guillemot)</a></li>
<li><a class="nav-link" href="#data-type"><span class="header-section-number">5.7</span> Data type</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/NINAnor/NIviz/blob/master/04-other_figures.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/NINAnor/NIviz/edit/master/04-other_figures.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>NIvis</strong>" was written by . It was last built on 2022-10-14.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
